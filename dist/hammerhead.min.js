/*! hammerhead 09-05-2014 */
var Hammerhead=function(a){pointPrototype={add:function(a){return b(this.x+a.x,this.y+a.y)},subtract:function(a){return b(this.x-a.x,this.y-a.y)},multiply:function(a){return b(this.x*a,this.y*a)},transform:function(a){return b(this.x*a.a+a.e,this.y*a.d+a.f)},scaleTransform:function(a){return b(this.x*a.a,this.y*a.d)}};var b=function(a,b){var c,d;void 0===b?void 0!==a.x?(d=a.y,c=a.x):void 0!==a.pageX?(d=a.pageY,c=a.pageX):void 0!==a.deltaX&&(d=a.deltaY,c=a.deltaX):(c=a,d=b);var e=Object.create(pointPrototype);return e.x=c,e.y=d,e};return a.Point=b,a}(Hammerhead||{}),Hammerhead=function(a){viewBoxPrototype={x0:function(){return this.getMinimal().x},y0:function(){return this.getMinimal().y},x1:function(){return this.getMaximal().x},y1:function(){return this.getMaximal().y},dX:function(){return this.x1()-this.x0()},dY:function(){return this.y1()-this.y0()},xMid:function(){return.5*(this.x0()+this.x1())},yMid:function(){return.5*(this.y0()+this.y1())},center:function(){return this.getMinimal().add(this.getMaximal()).multiply(.5)},extent:function(){return this.getMaximal().subtract(this.getMinimal())},toString:function(){return[this.x0(),this.y0(),this.dX(),this.dY()].join(" ")},translate:function(a){var c=this.getMinimal().subtract(a),d=this.getMaximal().subtract(a),e=b(c,d,this.getValidator());return e.valid()?e:null},scale:function(a,c){var d=1/a;c=c||this.center();var e=this.getMinimal().subtract(c).multiply(d).add(c),f=this.getMaximal().subtract(c).multiply(d).add(c),g=b(e,f,this.getValidator());return g.valid()?g:null}};var b=function(a,b,d){if(d=d||function(){return!0},"string"==typeof a)return c(a,b);var e=Object.create(viewBoxPrototype);return e.getMinimal=function(){return a},e.getMaximal=function(){return b},e.setMinimal=function(b){a=b},e.setMaximal=function(a){b=a},e.getValidator=function(){return d},e.valid=function(){return d.call(e)},e},c=function(c,d){var e=function(a){return parseInt(a,10)},f=c.split(" ").map(e),g=a.Point(f[0],f[1]),h=a.Point(f[2],f[3]),i=g.add(h);return b(g,i,d)};return a.ViewBox=b,a}(Hammerhead||{}),Hammerhead=function(a){var b={},c={throttleDelay:300,centerScale:4},d=function(d,e){function f(a){d.setAttribute("viewBox",a)}function g(a){return n=o.translate(a)||n,f(n.toString()),this}function h(a){var b=a.scaleTransform(d.getScreenCTM().inverse());return this.translate(b)}function i(a,b){return n=o.scale(a,b)||n,f(n.toString()),this}function j(a,b){var c=b.transform(d.getScreenCTM().inverse());return this.scale(a,c)}function k(){return o=n,this}function l(a,b){return a&&b?(n.setMinimal(a),n.setMaximal(b)):n=p,f(n.toString()),this}function m(a,b){b=b||e.centerScale;var c=p.extent().multiply(1/(2*b));return n.setMinimal(a.subtract(c)),n.setMaximal(a.add(c)),f(n.toString()),this}var n,o,p;c.conditions=function(){homeCenter=p.getMinimal().add(p.getMaximal()).multiply(.5);var a=this.dX()>=p.dX()/4&&this.dX()<=4*p.dX(),b=this.x0()<=homeCenter.x&&this.x1()>=homeCenter.x,c=this.y0()<=homeCenter.y&&this.y1()>=homeCenter.y;return a&&b&&c},e=_.extend({},c,e),p=n=o=a.ViewBox(d.getAttribute("viewBox"),e.conditions),f=_.throttle(f,e.throttleDelay);var q=Object.create(b);return[g,h,i,j,k,l,m].forEach(function(a){q[a.name]=a}),q};return a.MobileSVG=d,a}(Hammerhead||{}),Hammerhead=function(a){function b(a){var b=document.getElementById(a);if(b&&"svg"==b.tagName.toLowerCase())return b;throw"Id: "+a+" is not a SVG element"}function c(a,c){function g(a){a.gesture.preventDefault(),c.prefix(),a.target.ownerSVGElement===k&&i(m)}function h(){l.fix(),j(m),c.postfix()}function i(a){a.on("dragstart drag transformstart pinch",n),a.on("release",h)}function j(a){a.off("dragstart drag transformstart pinch",n),a.off("release",h)}c=_.extend({},f,c);var k=b(a),l=Hammerhead.MobileSVG(k,c),m=Hammer(document).on("touch",g),n=function(a){var b=a.gesture;b.preventDefault(),o[a.type](b)},o={dragstart:function(){l.fix()},drag:function(a){l.drag(d(a.deltaX,a.deltaY))},transformstart:function(){l.fix()},pinch:function(a){l.zoom(a.scale,d(a.center.pageX,a.center.pageY))}},p=Object.create(e);return p.drag=function(a,b){return l.drag(d(a,b)),this},p.dragX=function(a){return l.drag(d(a||c.dragX,0)),this},p.dragY=function(a){return l.drag(d(0,a||c.dragY)),this},p.zoom=function(a,b,c){l.zoom(c,d(a,b))},p.zoomIn=function(){l.scale(c.zoomIn)},p.zoomOut=function(){l.scale(c.zoomOut)},p.fix=function(){l.fix()},p._test={hammertime:m,handlers:o},p}var d=Hammerhead.Point,e={},f={dragX:100,dragY:100,zoomIn:1.25,zoomOut:.8,prefix:function(){},postfix:function(){}};return _.extend(c,a)}(Hammerhead||{}),Hammerhead=function(a){function b(a){return a.wheelDelta?a.wheelDelta:40*-a.detail}function c(a){function c(c){if(c.target.ownerSVGElement){console.log(c);var d=b(c),e=Math.pow(2,d/720);console.log(e),a.zoomIn(e),a.fix()}}document.addEventListener("mousewheel",c,!1),document.addEventListener("DOMMouseScroll",c,!1)}return a.MouseWheel=c,a}(Hammerhead||{});