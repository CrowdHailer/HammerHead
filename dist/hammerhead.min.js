/*! hammerhead 02-05-2014 */
function Point(a,b){this.x=a,this.y=b}Point.prototype={constructor:Point,add:function(a){return new Point(this.x+a.x,this.y+a.y)},subtract:function(a){return new Point(this.x-a.x,this.y-a.y)},multiply:function(a){return new Point(this.x*a,this.y*a)},mapTo:function(a){var b=a.getScreenCTM().inverse();return this.transform(b)},transform:function(a){var b=this.x,c=this.y;return new Point(b*a.a+a.e,c*a.d+a.f)},scaleTransform:function(a){return new Point(this.x*a.a,this.y*a.d)},scaleTo:function(a){var b=a.getScreenCTM().inverse();return this.scaleTransform(b)}};var ViewFrame;!function(){function a(a){return parseInt(a,10)}function b(b){var c=b.getAttribute("viewBox");if(!c)throw"Id: "+b.id+" has no viewBox attribute";var d=c.split(" ").map(a),e=new Point(d[0],d[1]),f=new Point(d[2],d[3]);return{origin:e,size:f}}ViewFrame=function(a,c,d,e){var f;if(void 0===c){var g=b(a);c=g.origin,d=g.size}f={origin:c,size:d},this.dX=function(){return d.x},this.dY=function(){return d.y},this.x0=function(){return c.x},this.y0=function(){return c.y},this.getOrigin=function(){return c},this.getSize=function(){return d},this.setOrigin=function(a){c=a},this.setSize=function(a){d=a},this.setViewBox=function(b){b=b||this.toString(),a.setAttribute("viewBox",b)},this.getHome=function(){return f},this.getElement=function(){return a},this.getInverseScreenCTM=function(){return e},this.updateScreenCTM=function(){var b=a.getScreenCTM().inverse();return window.devicePixelRatio||(b=b.scale(2)),e=b,b},e=e||this.updateScreenCTM()},ViewFrame.prototype.drag=function(a,b){return a=a.scaleTransform(this.getInverseScreenCTM()),this.translate(a,b)},ViewFrame.prototype.zoom=function(a,b,c){return a=a.transform(this.getInverseScreenCTM()),this.scale(a,b,c)},ViewFrame.prototype.translate=function(a,b){var c=this.getOrigin().subtract(a);if(b)return this.setOrigin(c),this.setViewBox(),this;var d=new ViewFrame(this.getElement(),c,this.getSize(),this.getInverseScreenCTM());return this.setViewBox(d.toString()),d},ViewFrame.prototype.scale=function(a,b,c){var d=this.getOrigin().subtract(a).multiply(b).add(a),e=this.getSize().multiply(b);if(c)return this.setOrigin(d),this.setSize(e),this.setViewBox(),this.updateScreenCTM(),this;var f=new ViewFrame(this.getElement(),d,e,this.getInverseScreenCTM());return this.setViewBox(f.toString()),f},ViewFrame.prototype.toString=function(){return[this.x0(),this.y0(),this.dX(),this.dY()].join(" ")},ViewFrame.prototype.home=function(a){var b=a||this.getHome();this.setOrigin(b.origin),this.setSize(b.size)}}();var Hammerhead;!function(){function a(a){return a&&"svg"==a.tagName.toLowerCase()}function b(b){var c=document.getElementById(b);if(a(c))return c;throw"Id: "+b+" is not a SVG element"}Hammerhead=function(a){function c(a){a.on("drag dragend",m),a.on("dragstart",dragstartHandler),a.on("pinch",pinchHandler),a.on("transformend",transformendHandler),a.on("release",f)}function d(a){a.off("drag dragend",m),a.off("dragstart",dragstartHandler),a.off("pinch",pinchHandler),a.off("transformend",transformendHandler),a.off("release",f)}function e(a){a.gesture.preventDefault(),a.target.ownerSVGElement===i&&c(k)}function f(){g&&alert("boo"),d(k)}var g,h,i=b(a),j=new ViewFrame(i),k=Hammer(document,{preventDefault:!0}).on("touch",e),l={drag:function(a){j.drag(new Point(a.deltaX,a.deltaY))},dragend:function(a){j.drag(new Point(a.deltaX,a.deltaY),!0)}},m=function(a){var b=a.gesture;b.preventDefault(),console.log(a.type),l[a.type](b)};dragstartHandler=function(a){a.gesture.preventDefault()},pinchHandler=function(a){a.gesture.preventDefault(),h=j.zoom(new Point(a.gesture.center.pageX,a.gesture.center.pageY),1/a.gesture.scale),g=!0},transformendHandler=function(a){a.gesture.preventDefault(),j.zoom(new Point(a.gesture.center.pageX,a.gesture.center.pageY),1/a.gesture.scale,!0),g=!1},this._test={hammertime:k}}}();